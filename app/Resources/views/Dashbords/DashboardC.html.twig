<!doctype html>
<html class="fixed sidebar-left-collapsed">
<head>

    <!-- Basic -->
    <meta charset="UTF-8">

    <title>Menu Collapsed Layout | Okler Themes | Porto-Admin</title>
    <meta name="keywords" content="HTML5 Admin Template"/>
    <meta name="description" content="Porto Admin - Responsive HTML5 Template">
    <meta name="author" content="okler.net">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>

    <!-- Web Fonts  -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800|Shadows+Into+Light"
          rel="stylesheet" type="text/css">

    <!-- Vendor CSS -->
    <link rel="stylesheet" href="{{ asset("Tamplate/vendor/bootstrap/css/bootstrap.css") }}"/>
    <link rel="stylesheet" href="{{ asset("Tamplate/vendor/font-awesome/css/font-awesome.css") }}"/>
    <link rel="stylesheet" href="{{ asset("Tamplate/vendor/magnific-popup/magnific-popup.css") }}"/>
    <link rel="stylesheet" href="{{ asset("Tamplate/vendor/bootstrap-datepicker/css/datepicker3.css") }}"/>
    <link rel="stylesheet" href='{{ asset("Tamplate/vendor/select2/select2.css") }}'/>

    <!-- ThemeCSS -->
    <link rel="stylesheet" href="{{ asset("Tamplate/stylesheets/theme.css") }}"/>

    <!-- Skin CSS -->
    <link rel="stylesheet" href="{{ asset("Tamplate/stylesheets/skins/default.css") }}"/>

    <!-- Theme Custom CSS -->
    <link rel="stylesheet" href="{{ asset("Tamplate/stylesheets/theme-custom.css") }}"/>

    <!-- Head Libs -->
    <script src="{{ asset("Tamplate/vendor/modernizr/modernizr.js") }}"></script>

</head>
<body>
<section class="body">

    <!-- start: header -->
    <header class="header">
        <div class="logo-container">
            <a href="../" class="logo">
                <img src={{ asset("Tamplate/images/carte-carburant.jpg") }} height="100" alt="Porto Admin"
                     style="margin-left: -15px;margin-top: -25px;"/>
            </a>

            <div class="visible-xs toggle-sidebar-left" data-toggle-class="sidebar-left-opened" data-target="html"
                 data-fire-event="sidebar-left-opened">
                <i class="fa fa-bars" aria-label="Toggle sidebar"></i>
            </div>
        </div>
        <div ><h2><B>Protail</B> <em>Gestion Cartes Pétrolières</em></h2></div>

        <!-- start: search & user box -->
        <div class="header-right" style="margin-top: -65px;">



            <span class="separator"></span>

            {{ block("userbox","::userbox.html.twig") }}
        </div>
        <!-- end: search & user box -->
    </header>
    <!-- end: header -->

    <div class="inner-wrapper">
        <!-- start: sidebar -->
        {{ block("sidebar","::menu.html.twig") }}


        <!-- end: sidebar -->

        <section role="main" class="content-body">
            <header class="page-header">
                <h2 style="margin-left: 40px;"> Dashboard</h2>

                <div class="right-wrapper pull-right">
                    <ol class="breadcrumbs">
                        <li>
                            <a href="index.html">
                                <i class="fa fa-home"></i>
                            </a>
                        </li>
                        <li><span>Layouts</span></li>
                        <li><span>Menu Collapsed</span></li>
                    </ol>

                    <a class="sidebar-right-toggle" data-open="sidebar-right"><i class="fa fa-chevron-left"></i></a>
                </div>
            </header>

            <!-- start: page -->
            <div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>



            <section class="col-md-4  panel ">
                <div class="panel-body">
                    <div class="col-md-6">
                        <label for="mois"><b>Mois:</b></label>

                        <select id="mois" data-plugin-selectTwo class="form-control populate">

                            <option value="1">Janvier</option>
                            <option value="2">Février</option>
                            <option value="3">Mars</option>
                            <option value="4">Avril</option>
                            <option value="5">Mai</option>
                            <option value="6">Juin</option>
                            <option value="7">Juillet</option>
                            <option value="8">Aout</option>
                            <option value="9">Septembre</option>
                            <option value="10">Octobre</option>
                            <option value="11">Novembre</option>
                            <option value="12">Décembre</option>

                        </select>
                    </div>
                    <div class="col-md-6">
                        <label for="Produit"><b>Produits:</b></label>

                        <select id="Produit" data-plugin-selectTwo class="form-control populate">

                            <option value="Tous" selected>Tous</option>
                            <option value="Gasoil 50">Gasoil 50</option>
                            <option value="Sans Plomb">Sans Plomb</option>
                            <option value="Gasoil">Gasoil</option>


                        </select>
                    </div>
                    <div class="spinner" id="spinner1">
                        <div class="rect1"></div>
                        <div class="rect2"></div>
                        <div class="rect3"></div>
                        <div class="rect4"></div>
                        <div class="rect5"></div>
                    </div>


                    <div class="gauge-chart">
                        <canvas id="gaugeBasic"
                                data-plugin-options='{ "minValue": 0,"value": 0, "maxValue": 5000 }'
                                style="width: 50%; height: auto;display: block;margin: 0 auto;"></canvas>

                        <label id="gaugeBasicTextfield"></label>

                    </div>

                </div>


            </section>
            <section class="col-md-8  panel ">
                <div class="panel-body">
                    <div >
                        <label for="mois2"><b>Mois:</b></label>

                        <select id="mois2" data-plugin-selectTwo class="form-control populate">

                            <option value="1">Janvier</option>
                            <option value="2">Février</option>
                            <option value="3">Mars</option>
                            <option value="4">Avril</option>
                            <option value="5">Mai</option>
                            <option value="6">Juin</option>
                            <option value="7">Juillet</option>
                            <option value="8">Aout</option>
                            <option value="9">Septembre</option>
                            <option value="10">Octobre</option>
                            <option value="11">Novembre</option>
                            <option value="12">Décembre</option>

                        </select>
                    </div>
                    <div class="spinner" id="spinner2">
                        <div class="rect1"></div>
                        <div class="rect2"></div>
                        <div class="rect3"></div>
                        <div class="rect4"></div>
                        <div class="rect5"></div>
                    </div>
                    <div id="DepenceDay"></div>
                </div>
            </section>



            <!-- end: page -->
        </section>
    </div>

    <aside id="sidebar-right" class="sidebar-right">
        <div class="nano">
            <div class="nano-content">
                <a href="#" class="mobile-close visible-xs">
                    Collapse <i class="fa fa-chevron-right"></i>
                </a>

                <div class="sidebar-right-wrapper">

                    <div class="sidebar-widget widget-calendar">
                        <h6>Upcoming Tasks</h6>
                        <div data-plugin-datepicker data-plugin-skin="dark"></div>

                        <ul>
                            <li>
                                <time datetime="2014-04-19T00:00+00:00">04/19/2014</time>
                                <span>Company Meeting</span>
                            </li>
                        </ul>
                    </div>

                    <div class="sidebar-widget widget-friends">
                        <h6>Friends</h6>
                        <ul>
                            <li class="status-online">
                                <figure class="profile-picture">
                                    <img src={{ asset("Tamplate/images/!sample-user.jpg") }} alt="Joseph_Doe"
                                         class="img-circle">
                                </figure>
                                <div class="profile-info">
                                    <span class="name">Joseph Doe Junior</span>
                                    <span class="title">Hey, how are you?</span>
                                </div>
                            </li>
                            <li class="status-online">
                                <figure class="profile-picture">
                                    <img src={{ asset("Tamplate/images/!sample-user.jpg") }} alt="Joseph_Doe"
                                         class="img-circle">
                                </figure>
                                <div class="profile-info">
                                    <span class="name">Joseph Doe Junior</span>
                                    <span class="title">Hey, how are you?</span>
                                </div>
                            </li>
                            <li class="status-offline">
                                <figure class="profile-picture">
                                    <img src={{ asset("Tamplate/images/!sample-user.jpg") }} alt="Joseph_Doe"
                                         class="img-circle">
                                </figure>
                                <div class="profile-info">
                                    <span class="name">Joseph Doe Junior</span>
                                    <span class="title">Hey, how are you?</span>
                                </div>
                            </li>
                            <li class="status-offline">
                                <figure class="profile-picture">
                                    <img src={{ asset("Tamplate/images/!sample-user.jpg") }} alt="Joseph_Doe"
                                         class="img-circle">
                                </figure>
                                <div class="profile-info">
                                    <span class="name">Joseph Doe Junior</span>
                                    <span class="title">Hey, how are you?</span>
                                </div>
                            </li>
                        </ul>
                    </div>

                </div>
            </div>
        </div>
    </aside>

    <!-- Vendor -->
    <script src="{{ asset("Tamplate/vendor/jquery/jquery.js") }}"></script>
    <script src="{{ asset("Tamplate/vendor/jquery-browser-mobile/jquery.browser.mobile.js") }}"></script>
    <script src="{{ asset("Tamplate/vendor/bootstrap/js/bootstrap.js") }}"></script>
    <script src="{{ asset("Tamplate/vendor/nanoscroller/nanoscroller.js") }}"></script>
    <script src="{{ asset("Tamplate/vendor/bootstrap-datepicker/js/bootstrap-datepicker.js") }}"></script>
    <script src="{{ asset("Tamplate/vendor/magnific-popup/magnific-popup.js") }}"></script>
    <script src="{{ asset("Tamplate/vendor/jquery-placeholder/jquery.placeholder.js") }}"></script>

    <script src="{{ asset("Tamplate/vendor/gauge/gauge.js") }}"></script>


    <script src="{{ asset("Tamplate/javascripts/highcharts.js") }}"></script>
    <script src="{{ asset("Tamplate/javascripts/highcharts-more.js") }}"></script>
    <script src="{{ asset("Tamplate/javascripts/highcharts-3d.js") }}"></script>
    <script src="{{ asset("Tamplate/javascripts/exporting.js") }}"></script>
    <script src="{{ asset("Tamplate/vendor/fullcalendar/lib/moment.min.js") }}"></script>

    <!-- Specific Page Vendor -->

    <!-- Theme Base, Components and Settings -->
    <script src="{{ asset("Tamplate/javascripts/theme.js") }}"></script>

    <!-- Theme Custom -->
    <script src="{{ asset("Tamplate/javascripts/theme.custom.js") }}"></script>

    <!-- Theme Initialization Files -->
    <script src="{{ asset("Tamplate/javascripts/theme.init.js") }}"></script>
    <script>

function DayDepence(mois) {
    $('#spinner2').show();
    $('#DepenceDay').hide();
    $.ajax({
        type: "POST",
        url: "{{ path('reportingC_P_CarteDepenceStat') }}",
        cache: false,
        success: function (rep) {

            console.log(rep);
            var year = moment(new Date().getYear() + 1900, 'YYYY').format('YYYY');
            var Depence = jQuery.parseJSON(rep);
            var data = [];
            var cat = [];
            for (var i = 1; i <= 31; i++)
                cat.push(i);
            console.log(data);


                /*  if (key != "all") {
                 if (TopClt[key] != 0) {
                 data.push([key, TopClt[key]]);
                 }*/
                var DepencePerDay = [];
                for (var keyday in Depence[mois]) {
                    //DepencePerDay.push(Depence[key][keyday])


                    data.push([Date.UTC(year,mois-1,keyday), Depence[mois][keyday]]);
                }

                //data.append() "['" + key + "'," + StationStat[key] + "],";
                /*}
                 else {
                 var ca = TopClt[key];
                 }*/

            var options = {

                chart: {
                    zoomType: 'x'
                },
                title: {
                    text: 'Suivie Consomation'
                },
                subtitle: {
                    text: document.ontouchstart === undefined ?
                        'Sélctioner une partie pour zoomer' : 'Pinch the chart to zoom in'
                },
                xAxis: {
                    type: 'datetime'
                },
                yAxis: {
                    title: {
                        text: 'Dépence (DT)'
                    }
                },
                legend: {
                    enabled: false
                },
                plotOptions: {
                    area: {
                        fillColor: {
                            linearGradient: {
                                x1: 0,
                                y1: 0,
                                x2: 0,
                                y2: 1
                            },
                            stops: [
                                [0, Highcharts.getOptions().colors[0]],
                                [1, Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]
                            ]
                        },
                        marker: {
                            radius: 2
                        },
                        lineWidth: 1,
                        states: {
                            hover: {
                                lineWidth: 1
                            }
                        },
                        threshold: null
                    }
                },

                series: [{
                    type: 'area',
                    name: 'Montant:',
                    data: data


                }]
            };
            Highcharts.chart('DepenceDay', options);
            //$(".sk-folding-cube").hide();
            $('#spinner2').hide();
            $('#DepenceDay').show();
        }
    });


}
        function initGauge(conso) {
            var target = $('#gaugeBasic'),
                opts = $.extend(true, {}, {
                    lines: 12, // The number of lines to draw
                    angle: 0.12, // The length of each line
                    lineWidth: 0.5, // The line thickness
                    pointer: {
                        length: 0.7, // The radius of the inner circle
                        strokeWidth: 0.05, // The rotation offset
                        color: '#444' // Fill color
                    },
                    limitMax: 'false', // If true, the pointer will not go past the end of the gauge
                    colorStart: '#0fc428', // Colors
                    colorStop: '#0ac415', // just experiment with them
                    strokeColor: '#F1F1F1', // to see which ones work best for you
                    generateGradient: true
                }, target.data('plugin-options'));

            var gauge = new Gauge(target.get(0)).setOptions(opts);

            //  gauge.minValue = 0; // set min gauge value
            gauge.maxValue = opts.maxValue; // set max gauge value
            gauge.animationSpeed = 5; // set animation speed (32 is default value)
            gauge.set(conso); // set actual value
            gauge.setTextField(document.getElementById("gaugeBasicTextfield"));

        }

        function litres() {
            $('#spinner1').show();
            var l = 0;
            $.ajax({
                type: "POST",
                url: "{{ path('reporting_C_Litres') }}",
                cache: false,
                data: {
                    mois: $('#mois').val(),
                    prod: $('#Produit').val()

                },
                success: function (rep) {
                    $('#spinner1').hide();
                    console.log(rep);
                    l = rep.litres;
                    console.log(l);
                    if (l == 0)
                        l = 0.00001;
                    initGauge(l);
                    if (l == 0.00001)
                        $('#gaugeBasicTextfield').html("0");

                    setTimeout(function () {
                        $('#gaugeBasicTextfield').html($('#gaugeBasicTextfield').html() + " Litres");

                    }, 1000);
                }
            });

        }

        function DepenceYear()
        {
            var essence = [];
            var gasoil = [];
            var gasoil50 = [];
            var year = moment(new Date().getYear() + 1900, 'YYYY').format('YYYY');
            var CA = 0;
            $.ajax({
                type: "POST",
                url: "{{ path('reporting_G-CAPerYear') }}",
                cache: false,
                success: function (rep) {
                    console.log(rep);
                    var CA_tot = jQuery.parseJSON(rep);
                    var bloc = "";
                    CA = CA_tot["all"];

                    for (var i = 1; i <= 12; i++) {
                        if (i < 10) {
                            bloc = "0" + i;
                        }
                        essence.push(CA_tot["essence"][bloc]);
                        gasoil.push(CA_tot["gasoil"][bloc]);
                        gasoil50.push(CA_tot["gasoil50"][bloc]);

                    }

                    console.log(essence);
                    var option = {

                        chart: {
                            type: 'column',
                            options3d: {
                                enabled: true,
                                alpha: 19,
                                beta: 19,
                                depth: 100
                            }
                        },
                        title: {
                            text: "Dépence Total en " + year + "<br>" + CA + " DT"
                        },


                        plotOptions: {
                            column: {
                                depth: 45

                            }
                        },
                        xAxis: {
                            categories: Highcharts.getOptions().lang.shortMonths
                        },
                        yAxis: {
                            title: {
                                text: ' Montant  (TND)'
                            }
                        },
                        series: [
                            {
                                name: 'Essence',
                                data: essence

                            }, {
                                name: 'Gasoil',
                                data: gasoil

                            }, {
                                name: 'Gasoil 50',
                                data: gasoil50

                            }
                        ],

                        tooltip: {
                            formatter: function() {
                                if (this.series.name=="Gasoil")
                                    return   "<b> " + this.series.name+ '</b> <br> '+"<span style=\"color:"+this.point.color+"\">\u25CF</span>"+' <b>' + this.y + '</b> DT  <br>  ';
                                else if (this.series.name=="Gasoil 50")
                                    return" <b>" + this.series.name+ '</b> <br> '+"<span style=\"color:"+this.point.color+"\">\u25CF</span>"+' <b>' + this.y + '</b> DT  <br>  ';
                                else
                                    return "<b>" +  this.series.name+ '</b> <br> '+"<span style=\"color:"+this.point.color+"\">\u25CF</span>"+' <b>' + this.y + '</b> DT  <br>  ';

                            }
                        }
                    };
                    Highcharts.chart('container', option);

                }
            });

        }

        $(document).ready(function () {
            $('#mois').val(new Date().getMonth() + 1).trigger('change');
            $('#mois2').val(new Date().getMonth() + 1).trigger('change');
            console.log($('#Produit').val());
            console.log($("#mois").val());
            litres();
            DepenceYear();
            DayDepence(moment(new Date().getMonth() + 1, 'MM').format('M'));
            $("#mois2").change(function () {

                DayDepence($("#mois2").val());
            });

            $("#mois").change(function () {

                litres();
            });
            $("#Produit").change(function () {
                litres();
            });

        });
    </script>
</section>
</body>
</html>