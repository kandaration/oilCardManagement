<!doctype html>
<html class="fixed sidebar-left-collapsed">
<head>

    <!-- Basic -->
    <meta charset="UTF-8">

    <title>Menu Collapsed Layout | Okler Themes | Porto-Admin</title>
    <meta name="keywords" content="HTML5 Admin Template"/>
    <meta name="description" content="Porto Admin - Responsive HTML5 Template">
    <meta name="author" content="okler.net">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>

    <!-- Web Fonts  -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800|Shadows+Into+Light"
          rel="stylesheet" type="text/css">

    <!-- Vendor CSS -->
    <link rel="stylesheet" href='{{ asset("Tamplate/vendor/bootstrap/css/bootstrap.css") }}'/>
    <link rel="stylesheet" href='{{ asset("Tamplate/vendor/font-awesome/css/font-awesome.css") }}'/>
    <link rel="stylesheet" href='{{ asset("Tamplate/vendor/magnific-popup/magnific-popup.css") }}'/>
    <link rel="stylesheet" href='{{ asset("Tamplate/vendor/bootstrap-datepicker/css/datepicker3.css") }}'/>
    <link rel="stylesheet" href='{{ asset("Tamplate/vendor/select2/select2.css") }}'/>


    <!-- ThemeCSS -->
    <link rel="stylesheet" href='{{ asset("Tamplate/stylesheets/theme.css") }}'/>

    <!-- Skin CSS -->
    <link rel="stylesheet" href='{{ asset("Tamplate/stylesheets/skins/default.css") }}'/>

    <!-- Theme Custom CSS -->
    <link rel="stylesheet" href='{{ asset("Tamplate/stylesheets/theme-custom.css") }}'/>

    <!-- Head Libs -->
    <script src="{{ asset("Tamplate/vendor/modernizr/modernizr.js") }}"></script>
    <style>
        /* Always set the map height explicitly to define the size of the div
         * element that contains the map. */
        #map {
            height: 100%;
        }

        /* Optional: Makes the sample page fill the window. */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }


    </style>

</head>
<body>

<section class="body">

    <!-- start: header -->
    <header class="header">
        <div class="logo-container">
            <a href="../" class="logo">
                <img src={{ asset("Tamplate/images/carte-carburant.jpg") }} height="100" alt="Porto Admin"
                     style="margin-left: -15px;margin-top: -25px;"/>
            </a>

            <div class="visible-xs toggle-sidebar-left" data-toggle-class="sidebar-left-opened" data-target="html"
                 data-fire-event="sidebar-left-opened">
                <i class="fa fa-bars" aria-label="Toggle sidebar"></i>
            </div>
        </div>
        <div ><h2><B>Portail</B> <em>Gestion Cartes Pétrolières</em></h2></div>

        <!-- start: search & user box -->
        <div class="header-right" style="margin-top: -65px;">



            <span class="separator"></span>

            {{ block("userbox","::userbox.html.twig") }}
        </div>
        <!-- end: search & user box -->
    </header>
    <!-- end: header -->

    <div class="inner-wrapper">
        <!-- start: sidebar -->

        {{ block("sidebar","::menu.html.twig") }}


        <!-- end: sidebar -->
        <section role="main" class="content-body">
            <header class="page-header">
                <h2 style="margin-left: 53px;">Dashboard</h2>

            </header>

            <!-- start: page -->

            <div class="sk-folding-cube">
                <div class="sk-cube1 sk-cube"></div>
                <div class="sk-cube2 sk-cube"></div>
                <div class="sk-cube4 sk-cube"></div>
                <div class="sk-cube3 sk-cube"></div>
            </div>
            <div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

            <div class="col-md-6" id="disk" style="height: 489px"></div>

            <section class="col-md-6  panel ">
                <div class="panel-body">
                    <div class="col-md-6">
                        <label for="mois"><b>Mois:</b></label>

                        <select id="mois" data-plugin-selectTwo class="form-control populate">

                            <option value="1">Janvier</option>
                            <option value="2">Février</option>
                            <option value="3">Mars</option>
                            <option value="4">Avril</option>
                            <option value="5">Mai</option>
                            <option value="6">Juin</option>
                            <option value="7">Juillet</option>
                            <option value="8">Aout</option>
                            <option value="9">Septembre</option>
                            <option value="10">Octobre</option>
                            <option value="11">Novembre</option>
                            <option value="12">Décembre</option>

                        </select>
                    </div>

                    <div class="spinner">
                        <div class="rect1"></div>
                        <div class="rect2"></div>
                        <div class="rect3"></div>
                        <div class="rect4"></div>
                        <div class="rect5"></div>
                    </div>


                    <div id="TopClt" style="min-width: 310px; height:100%; max-width: 600px; margin: 0 auto"></div>
                </div>


            </section>


            <!-- end: page -->
        </section>
    </div>

    <aside id="sidebar-right" class="sidebar-right">
        <div class="nano">
            <div class="nano-content">
                <a href="#" class="mobile-close visible-xs">
                    Collapse <i class="fa fa-chevron-right"></i>
                </a>

                <div class="sidebar-right-wrapper">

                    <div class="sidebar-widget widget-calendar">
                        <h6>Upcoming Tasks</h6>
                        <div data-plugin-datepicker data-plugin-skin="dark"></div>

                        <ul>
                            <li>
                                <time datetime="2014-04-19T00:00+00:00">04/19/2014</time>
                                <span>Company Meeting</span>
                            </li>
                        </ul>
                    </div>

                    <div class="sidebar-widget widget-friends">
                        <h6>Friends</h6>
                        <ul>
                            <li class="status-online">
                                <figure class="profile-picture">
                                    <img src={{ asset("Tamplate/images/!sample-user.jpg") }} alt="Joseph_Doe"
                                         class="img-circle">
                                </figure>
                                <div class="profile-info">
                                    <span class="name">Joseph Doe Junior</span>
                                    <span class="title">Hey, how are you?</span>
                                </div>
                            </li>
                            <li class="status-online">
                                <figure class="profile-picture">
                                    <img src={{ asset("Tamplate/images/!sample-user.jpg") }} alt="Joseph_Doe"
                                         class="img-circle">
                                </figure>
                                <div class="profile-info">
                                    <span class="name">Joseph Doe Junior</span>
                                    <span class="title">Hey, how are you?</span>
                                </div>
                            </li>
                            <li class="status-offline">
                                <figure class="profile-picture">
                                    <img src={{ asset("Tamplate/images/!sample-user.jpg") }} alt="Joseph_Doe"
                                         class="img-circle">
                                </figure>
                                <div class="profile-info">
                                    <span class="name">Joseph Doe Junior</span>
                                    <span class="title">Hey, how are you?</span>
                                </div>
                            </li>
                            <li class="status-offline">
                                <figure class="profile-picture">
                                    <img src={{ asset("Tamplate/images/!sample-user.jpg") }} alt="Joseph_Doe"
                                         class="img-circle">
                                </figure>
                                <div class="profile-info">
                                    <span class="name">Joseph Doe Junior</span>
                                    <span class="title">Hey, how are you?</span>
                                </div>
                            </li>
                        </ul>
                    </div>

                </div>
            </div>
        </div>
    </aside>
</section>
<!-- Vendor -->
<script src="{{ asset("Tamplate/vendor/jquery/jquery.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/jquery-browser-mobile/jquery.browser.mobile.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/bootstrap/js/bootstrap.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/nanoscroller/nanoscroller.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/bootstrap-datepicker/js/bootstrap-datepicker.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/magnific-popup/magnific-popup.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/jquery-placeholder/jquery.placeholder.js") }}"></script>

<!-- Specific Page Vendor -->


<script src="{{ asset("Tamplate/vendor/jquery-appear/jquery.appear.js") }}"></script>
<script

        src="http://maps.googleapis.com/maps/api/js?key=AIzaSyC9rDza-dqwgPv09wI8eQRnzLAUYgC0DRk"></script>
<script src="https://cdn.jsdelivr.net/gmap3/7.2.0/gmap3.min.js"></script>
<!--<script src="{{ asset("Tamplate/vendor/gmaps/gmaps.js") }}"></script>-->
<script src="{{ asset("Tamplate/vendor/jquery-ui/js/jquery-ui-1.10.4.custom.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/jquery-ui-touch-punch/jquery.ui.touch-punch.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/select2/select2.js") }}"></script>

<script src="{{ asset("Tamplate/vendor/jquery-maskedinput/jquery.maskedinput.js") }}"></script>

<script src="{{ asset("Tamplate/vendor/bootstrap-timepicker/js/bootstrap-timepicker.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/fuelux/js/spinner.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/dropzone/dropzone.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/bootstrap-markdown/js/markdown.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/bootstrap-markdown/js/to-markdown.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/bootstrap-markdown/js/bootstrap-markdown.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/codemirror/lib/codemirror.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/codemirror/addon/selection/active-line.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/codemirror/addon/edit/matchbrackets.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/codemirror/mode/javascript/javascript.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/codemirror/mode/xml/xml.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/codemirror/mode/htmlmixed/htmlmixed.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/codemirror/mode/css/css.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/summernote/summernote.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/bootstrap-maxlength/bootstrap-maxlength.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/ios7-switch/ios7-switch.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/gauge/gauge.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/gauge/gauge.js") }}"></script>
<script src="{{ asset("Tamplate/vendor/fullcalendar/lib/moment.min.js") }}"></script>


<script src="{{ asset("Tamplate/javascripts/highcharts.js") }}"></script>
<script src="{{ asset("Tamplate/javascripts/highcharts-more.js") }}"></script>
<script src="{{ asset("Tamplate/javascripts/highcharts-3d.js") }}"></script>
<script src="{{ asset("Tamplate/javascripts/exporting.js") }}"></script>

<script>
    $.fn.datepicker.defaults.format = "dd/mm/yyyy";
</script>
<!-- Theme Base, Components and Settings -->
<script src="{{ asset("Tamplate/javascripts/theme.js") }}"></script>

<!-- Theme Custom -->
<script src="{{ asset("Tamplate/javascripts/theme.custom.js") }}"></script>

<!-- Theme Initialization Files -->
<script src="{{ asset("Tamplate/javascripts/theme.init.js") }}"></script>

<!-- Examples -->

<script src="{{ asset("Tamplate/javascripts/pages/examples.timeline.js") }}"></script>
<script src="{{ asset("Tamplate/javascripts/forms/examples.advanced.form.js") }}"></script>


<script>

    function CAToday() {
        console.log("lkllll");
        var data = [];
        $.ajax({
            type: "POST",
            url: "{{ path('reporting_G-CAtoDay') }}",
            cache: false,
            success: function (rep) {
                var StationStat = jQuery.parseJSON(rep);

                console.log(data);
                for (var key in StationStat) {

                    if (key != "all") {

                        data.push([key, StationStat[key]]);
                        //data.append() "['" + key + "'," + StationStat[key] + "],";
                    }
                    else {
                        var ca = StationStat[key];
                    }
                }
                console.log(data);
                var options = {
                    chart: {
                        type: 'pie',
                        options3d: {
                            enabled: true,
                            alpha: 45,
                            beta: 0
                        }
                    },
                    title: {
                        text: "Chiffre d'affaire quotidien: <br>" + ca + "DT"
                    },

                    plotOptions: {
                        pie: {
                            allowPointSelect: true,
                            cursor: 'pointer',
                            depth: 35,
                            dataLabels: {
                                enabled: true,
                                format: '<b>{point.name}</b>: {point.percentage:.1f} %'
                            }
                        }
                    },
                    series: [{
                        type: 'pie',
                        name: 'Montant',
                        data: data

                    }]
                };
                //console.log(options);
                Highcharts.chart('disk', options);
                //$("#disk").highcharts(options);
            }

        });


    }
    function YearStat() {

        var essence = [];
        var gasoil = [];
        var gasoil50 = [];
        var year = moment(new Date().getYear() + 1900, 'YYYY').format('YYYY');
        var CA = 0;
        $(".sk-folding-cube").show();
        $.ajax({
            type: "POST",
            url: "{{ path('reporting_G-CAPerYear') }}",
            cache: false,
            success: function (rep) {
                console.log(rep);
                var CA_tot = jQuery.parseJSON(rep);
                var bloc = "";
                CA = CA_tot["all"];

                for (var i = 1; i <= 12; i++) {
                    if (i < 10) {
                        bloc = "0" + i;
                    }
                    essence.push(CA_tot["essence"][bloc]);
                    gasoil.push(CA_tot["gasoil"][bloc]);
                    gasoil50.push(CA_tot["gasoil50"][bloc]);

                }

                console.log(essence);
                var option = {

                    chart: {
                        type: 'column',
                        options3d: {
                            enabled: true,
                            alpha: 19,
                            beta: 19,
                            depth: 100
                        }
                    },
                    title: {
                        text: "Chiffre d'affaire de " + year + "<br>" + CA + " DT"
                    },


                    plotOptions: {
                        column: {
                            depth: 45

                        }
                    },
                    xAxis: {
                        categories: Highcharts.getOptions().lang.shortMonths
                    },
                    yAxis: {
                        title: {
                            text: ' Montant  (TND)'
                        }
                    },
                    series: [
                        {
                            name: 'Essence',
                            data: essence

                        }, {
                            name: 'Gasoil',
                            data: gasoil

                        }, {
                            name: 'Gasoil 50',
                            data: gasoil50

                        }
                    ],

                    tooltip: {
                        formatter: function() {
                            if (this.series.name=="Gasoil")
                                return   "<b> " + this.series.name+ '</b> <br> '+"<span style=\"color:"+this.point.color+"\">\u25CF</span>"+' <b>' + this.y + '</b> DT  <br>  '+"<span style=\"color:"+this.point.color+"\">\u25CF</span>"+  (this.y /1.140).toFixed(2)+" L";
                            else if (this.series.name=="Gasoil 50")
                                return" <b>" + this.series.name+ '</b> <br> '+"<span style=\"color:"+this.point.color+"\">\u25CF</span>"+' <b>' + this.y + '</b> DT  <br>  '+"<span style=\"color:"+this.point.color+"\">\u25CF</span>"+ (this.y /1.420).toFixed(2);
                            else
                                return "<b>" +  this.series.name+ '</b> <br> '+"<span style=\"color:"+this.point.color+"\">\u25CF</span>"+' <b>' + this.y + '</b> DT  <br>  '+"<span style=\"color:"+this.point.color+"\">\u25CF</span>" + (this.y /1.650).toFixed(2);

                        }
                    }
                };
                $(".sk-folding-cube").hide();
                Highcharts.chart('container', option);

            }
        });


    }

    function topClt() {
        var month = moment(new Date().getMonth() + 1, 'MM').format('MMMM');

        var data = [];
        $.ajax({
            type: "POST",
            url: "{{ path('reporting_G-TopClt') }}",
            cache: false,
            data: {mois: $('#mois').val()},
            success: function (rep) {
                console.log(rep);
                var TopClt = jQuery.parseJSON(rep);

                console.log(data);
                for (var key in TopClt) {

                    if (key != "all") {
                        if (TopClt[key] != 0) {
                            data.push([key, TopClt[key]]);
                        }

                        //data.append() "['" + key + "'," + StationStat[key] + "],";
                    }
                    else {
                        var ca = TopClt[key];
                    }
                }
                var options = {
                    chart: {
                        type: 'pie',
                        options3d: {
                            enabled: true,
                            alpha: 45
                        }
                    },
                    title: {
                        text: 'Dépense Client en Mai '  + '<br>' + ca + 'DT'
                    },
                    subtitle: {
                        text: ''
                    },


                    plotOptions: {

                        pie: {
                            innerSize: 100,
                            depth: 40,
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true,
                                format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                style: {
                                    color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                }
                            }
                        }
                    },
                    series: [{
                        type: 'pie',
                        name: 'Montant',
                        innerSize: '50%',
                        data: data
                    }]
                };
                Highcharts.chart('TopClt', options);

            }
        });

    }

    $(document).ready(function () {

        $('#mois').val(new Date().getMonth() + 1).trigger('change');
        YearStat();
        $("#mois").change(function () {

            topClt();
        });


        CAToday();
        topClt();


    });
</script>

</body>
</html>